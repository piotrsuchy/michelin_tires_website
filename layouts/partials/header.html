<header class="bg-[#004B93] text-white shadow-lg sticky top-0 z-50 transition-all duration-300">
  <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
    <!-- Logo/Brand Name -->
    <a href="/" class="group flex items-center gap-3">
      <div class="relative overflow-hidden transition-transform duration-300 group-hover:scale-105">
        <img src="/images/michelin_logo_2.png" alt="PS-Sport Sport Tires Logo" class="h-10 w-auto drop-shadow-md" />
      </div>
      <div class="flex flex-col">
        <span
          class="text-xl font-extrabold tracking-tight uppercase italic leading-none text-white group-hover:text-[#FFCD00] transition-colors">PS-Sport</span>
        <span class="text-xs font-medium tracking-widest text-gray-300 uppercase">Motorsport Tires</span>
      </div>
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center gap-1">
      <a href="/"
        class="relative px-4 py-2 text-sm font-bold uppercase tracking-wider text-white hover:text-[#FFCD00] transition-colors group">
        Home
        <span
          class="absolute bottom-0 left-0 w-full h-0.5 bg-[#FFCD00] transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
      </a>

      <!-- Rally Dropdown -->
      <div class="relative group">
        <button
          class="dropdown-toggle flex items-center gap-1 px-4 py-2 text-sm font-bold uppercase tracking-wider text-white hover:text-[#FFCD00] transition-colors focus:outline-none group-hover:text-[#FFCD00]"
          data-dropdown="rally-dropdown">
          <span>Rally</span>
          <svg class="h-4 w-4 transform transition-transform duration-300 group-hover:rotate-180" fill="none"
            stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <!-- Invisible bridge to prevent closing when moving to menu -->
        <div class="absolute top-full left-0 w-full h-2"></div>

        <div id="rally-dropdown"
          class="dropdown-menu absolute left-0 mt-3 w-56 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden transform opacity-0 scale-95 invisible transition-all duration-200 origin-top-left group-hover:opacity-100 group-hover:scale-100 group-hover:visible">
          <div class="py-2">
            <div
              class="px-4 py-2 bg-gray-50 border-b border-gray-100 text-xs font-bold text-gray-400 uppercase tracking-wider">
              Categories
            </div>
            <a href="/rally/asphalt"
              class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-[#004B93] transition-colors group/item">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-300 group-hover/item:bg-[#004B93] transition-colors"></span>
              <span class="font-medium">Asphalt</span>
            </a>
            <a href="/rally/gravel"
              class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-[#004B93] transition-colors group/item">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-300 group-hover/item:bg-[#004B93] transition-colors"></span>
              <span class="font-medium">Gravel</span>
            </a>
            <a href="/rally/snow_and_ice"
              class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-[#004B93] transition-colors group/item">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-300 group-hover/item:bg-[#004B93] transition-colors"></span>
              <span class="font-medium">Snow & Ice</span>
            </a>
          </div>
        </div>
      </div>

      <!-- Circuit Dropdown -->
      <div class="relative group">
        <button
          class="dropdown-toggle flex items-center gap-1 px-4 py-2 text-sm font-bold uppercase tracking-wider text-white hover:text-[#FFCD00] transition-colors focus:outline-none group-hover:text-[#FFCD00]"
          data-dropdown="circuit-dropdown">
          <span>Circuit</span>
          <svg class="h-4 w-4 transform transition-transform duration-300 group-hover:rotate-180" fill="none"
            stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <!-- Invisible bridge -->
        <div class="absolute top-full left-0 w-full h-2"></div>

        <div id="circuit-dropdown"
          class="dropdown-menu absolute left-0 mt-3 w-64 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden transform opacity-0 scale-95 invisible transition-all duration-200 origin-top-left group-hover:opacity-100 group-hover:scale-100 group-hover:visible">
          <div class="py-2">
            <div
              class="px-4 py-2 bg-gray-50 border-b border-gray-100 text-xs font-bold text-gray-400 uppercase tracking-wider">
              Series
            </div>
            <a href="/circuit/prototype_formula"
              class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-[#004B93] transition-colors group/item">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-300 group-hover/item:bg-[#004B93] transition-colors"></span>
              <span class="font-medium">Prototype Formula</span>
            </a>
            <a href="/circuit/touring_gt"
              class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-[#004B93] transition-colors group/item">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-300 group-hover/item:bg-[#004B93] transition-colors"></span>
              <span class="font-medium">Touring GT</span>
            </a>
            <a href="/circuit/porsche_cup"
              class="flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-[#004B93] transition-colors group/item">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-300 group-hover/item:bg-[#004B93] transition-colors"></span>
              <span class="font-medium">Porsche Cup</span>
            </a>
          </div>
        </div>
      </div>

      <a href="/hillclimbing"
        class="relative px-4 py-2 text-sm font-bold uppercase tracking-wider text-white hover:text-[#FFCD00] transition-colors group">
        Hillclimbing
        <span
          class="absolute bottom-0 left-0 w-full h-0.5 bg-[#FFCD00] transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
      </a>
      <a href="/raid"
        class="relative px-4 py-2 text-sm font-bold uppercase tracking-wider text-white hover:text-[#FFCD00] transition-colors group">
        Raid
        <span
          class="absolute bottom-0 left-0 w-full h-0.5 bg-[#FFCD00] transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
      </a>

      <!-- Contact Button -->
      <a href="/contact"
        class="ml-4 px-6 py-2.5 rounded-full bg-[#FFCD00] text-[#004B93] text-sm font-bold uppercase tracking-wide hover:bg-white hover:shadow-lg transition-all duration-300 transform hover:-translate-y-0.5">
        Contact Us
      </a>
    </nav>

    <!-- Mobile Menu Button -->
    <div class="md:hidden">
      <button id="mobile-menu-button" class="p-2 text-white hover:text-[#FFCD00] focus:outline-none transition-colors">
        <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path id="menu-icon" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16" />
          <path id="close-icon" class="hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Nav -->
  <div id="mobile-menu" class="md:hidden hidden bg-[#003366] border-t border-[#004B93] shadow-inner">
    <nav class="px-4 py-4 space-y-2">
      <a href="/"
        class="block px-4 py-3 rounded-lg text-white font-medium hover:bg-[#004B93] hover:text-[#FFCD00] transition-all">Home</a>

      <!-- Rally Mobile Section -->
      <div class="space-y-1">
        <button
          class="w-full flex items-center justify-between px-4 py-3 rounded-lg text-white font-medium hover:bg-[#004B93] transition-all"
          onclick="this.nextElementSibling.classList.toggle('hidden')">
          <span>Rally</span>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div class="hidden grid bg-[rgb(0,50,100)] rounded-lg overflow-hidden py-2 ml-4 border-l-2 border-[#FFCD00]">
          <a href="/rally/asphalt"
            class="block px-4 py-2 text-sm text-gray-200 hover:text-white hover:bg-[#004B93]">Asphalt</a>
          <a href="/rally/gravel"
            class="block px-4 py-2 text-sm text-gray-200 hover:text-white hover:bg-[#004B93]">Gravel</a>
          <a href="/rally/snow_and_ice"
            class="block px-4 py-2 text-sm text-gray-200 hover:text-white hover:bg-[#004B93]">Snow & Ice</a>
        </div>
      </div>

      <!-- Circuit Mobile Section -->
      <div class="space-y-1">
        <button
          class="w-full flex items-center justify-between px-4 py-3 rounded-lg text-white font-medium hover:bg-[#004B93] transition-all"
          onclick="this.nextElementSibling.classList.toggle('hidden')">
          <span>Circuit</span>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div class="hidden grid bg-[#003366] rounded-lg overflow-hidden py-2 ml-4 border-l-2 border-[#FFCD00]">
          <a href="/circuit/prototype_formula"
            class="block px-4 py-2 text-sm text-gray-200 hover:text-white hover:bg-[#004B93]">Prototype Formula</a>
          <a href="/circuit/touring_gt"
            class="block px-4 py-2 text-sm text-gray-200 hover:text-white hover:bg-[#004B93]">Touring GT</a>
          <a href="/circuit/porsche_cup"
            class="block px-4 py-2 text-sm text-gray-200 hover:text-white hover:bg-[#004B93]">Porsche Cup</a>
        </div>
      </div>

      <a href="/hillclimbing"
        class="block px-4 py-3 rounded-lg text-white font-medium hover:bg-[#004B93] hover:text-[#FFCD00] transition-all">Hillclimbing</a>
      <a href="/raid"
        class="block px-4 py-3 rounded-lg text-white font-medium hover:bg-[#004B93] hover:text-[#FFCD00] transition-all">Raid</a>
      <a href="/contact"
        class="block px-4 py-3 rounded-lg bg-[#FFCD00] text-[#004B93] font-bold text-center mt-4">Contact Us</a>
    </nav>
  </div>
</header>

<script>
  // Modern dropdown functionality
  document.addEventListener('DOMContentLoaded', function () {
    const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
    const dropdownMenus = document.querySelectorAll('.dropdown-menu');
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIcon = document.getElementById('menu-icon');
    const closeIcon = document.getElementById('close-icon');

    // Desktop dropdown functionality
    dropdownToggles.forEach(toggle => {
      const dropdownId = toggle.getAttribute('data-dropdown');
      const dropdown = document.getElementById(dropdownId);
      const arrow = toggle.querySelector('svg');

      // Toggle dropdown on click
      toggle.addEventListener('click', function (e) {
        e.stopPropagation();

        // Close all other dropdowns
        dropdownMenus.forEach(menu => {
          if (menu.id !== dropdownId) {
            closeDropdown(menu);
          }
        });

        // Toggle current dropdown
        if (dropdown.classList.contains('opacity-0')) {
          openDropdown(dropdown, arrow);
        } else {
          closeDropdown(dropdown, arrow);
        }
      });

      // Hover effects for better UX
      toggle.addEventListener('mouseenter', function () {
        if (!dropdown.classList.contains('opacity-0')) return;

        // Close other dropdowns on hover
        dropdownMenus.forEach(menu => {
          if (menu.id !== dropdownId) {
            closeDropdown(menu);
          }
        });

        openDropdown(dropdown, arrow);
      });

      // Keep dropdown open when hovering over it
      dropdown.addEventListener('mouseenter', function () {
        openDropdown(dropdown, arrow);
      });

      // Close dropdown when mouse leaves the container
      toggle.parentElement.addEventListener('mouseleave', function () {
        setTimeout(() => {
          if (!toggle.parentElement.matches(':hover')) {
            closeDropdown(dropdown, arrow);
          }
        }, 150);
      });
    });

    // Close dropdowns when clicking outside
    document.addEventListener('click', function () {
      dropdownMenus.forEach(menu => closeDropdown(menu));
    });

    // Mobile menu functionality
    mobileMenuButton.addEventListener('click', function () {
      mobileMenu.classList.toggle('hidden');
      menuIcon.classList.toggle('hidden');
      closeIcon.classList.toggle('hidden');
    });

    // Close mobile menu when clicking on links
    mobileMenu.addEventListener('click', function (e) {
      if (e.target.tagName === 'A') {
        mobileMenu.classList.add('hidden');
        menuIcon.classList.remove('hidden');
        closeIcon.classList.add('hidden');
      }
    });

    // Helper functions
    function openDropdown(dropdown, arrow = null) {
      dropdown.classList.remove('opacity-0', 'invisible', 'scale-95');
      dropdown.classList.add('opacity-100', 'visible', 'scale-100');
      if (arrow) {
        arrow.classList.add('rotate-180');
      }
    }

    function closeDropdown(dropdown, arrow = null) {
      dropdown.classList.add('opacity-0', 'invisible', 'scale-95');
      dropdown.classList.remove('opacity-100', 'visible', 'scale-100');
      if (arrow) {
        arrow.classList.remove('rotate-180');
      }
    }

    // Handle escape key
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') {
        dropdownMenus.forEach(menu => closeDropdown(menu));
        if (!mobileMenu.classList.contains('hidden')) {
          mobileMenu.classList.add('hidden');
          menuIcon.classList.remove('hidden');
          closeIcon.classList.add('hidden');
        }
      }
    });
  });
</script>